kind: ConfigMap
apiVersion: v1
metadata:
  name: fake-data
data:
  db.json: |-
    {
        "risks": {
          "data":
            [
              {
                "kind": "Deployment",
                "name": "echo-deployment",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 10,
                  "riskCategory": "High",
                  "riskItems": [
                    {
                      "name": "privileged",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Processes inside a privileged containers get full access to the code. A malicious, or library, can compromise the host and the entire cluster",
                      "score": 6
                    },
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "IngressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "A good ingress network policy would prevent external IPs to access a workload accidentally exposed to the host IP",
                      "score": 0.6
                    },
                    {
                      "name": "EgressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "An egress network policy can prevent the workload to be leveraged to perform lateral movement and data ex-filtration",
                      "score": 0.8
                    },
                    {
                      "name": "ExposedByLoadBalancer",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "ExposedByNodePort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Deployment",
                "name": "dep-test",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 5.2224,
                  "riskCategory": "Medium",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "IngressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "A good ingress network policy would prevent external IPs to access a workload accidentally exposed to the host IP",
                      "score": 0.6
                    },
                    {
                      "name": "EgressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "An egress network policy can prevent the workload to be leveraged to perform lateral movement and data ex-filtration",
                      "score": 0.8
                    },
                    {
                      "name": "ExposedByLoadBalancer",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "ExposedByNodePort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "DaemonSet",
                "name": "echo-daemon",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "StatefulSet",
                "name": "echo-state",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 10,
                  "riskCategory": "High",
                  "riskItems": [
                    {
                      "name": "privileged",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Processes inside a privileged containers get full access to the code. A malicious, or library, can compromise the host and the entire cluster",
                      "score": 6
                    },
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    },
                    {
                      "name": "ShareHostNetwork",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "May be exposed to external network and the Internet (Share Host Network), Can sniff traffic from host and other containers (Share Host Network)",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Pod",
                "name": "echo-a",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Pod",
                "name": "echo-b",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Deployment",
                "name": "dep-test",
                "namespace": "test",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Deployment",
                "name": "echo-deployment",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 10,
                  "riskCategory": "High",
                  "riskItems": [
                    {
                      "name": "privileged",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Processes inside a privileged containers get full access to the code. A malicious, or library, can compromise the host and the entire cluster",
                      "score": 6
                    },
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "IngressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "A good ingress network policy would prevent external IPs to access a workload accidentally exposed to the host IP",
                      "score": 0.6
                    },
                    {
                      "name": "EgressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "An egress network policy can prevent the workload to be leveraged to perform lateral movement and data ex-filtration",
                      "score": 0.8
                    },
                    {
                      "name": "ExposedByLoadBalancer",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "ExposedByNodePort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Deployment",
                "name": "dep-test",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 5.2224,
                  "riskCategory": "Medium",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "IngressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "A good ingress network policy would prevent external IPs to access a workload accidentally exposed to the host IP",
                      "score": 0.6
                    },
                    {
                      "name": "EgressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "An egress network policy can prevent the workload to be leveraged to perform lateral movement and data ex-filtration",
                      "score": 0.8
                    },
                    {
                      "name": "ExposedByLoadBalancer",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "ExposedByNodePort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "DaemonSet",
                "name": "echo-daemon",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "StatefulSet",
                "name": "echo-state",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 10,
                  "riskCategory": "High",
                  "riskItems": [
                    {
                      "name": "privileged",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Processes inside a privileged containers get full access to the code. A malicious, or library, can compromise the host and the entire cluster",
                      "score": 6
                    },
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    },
                    {
                      "name": "ShareHostNetwork",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "May be exposed to external network and the Internet (Share Host Network), Can sniff traffic from host and other containers (Share Host Network)",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Pod",
                "name": "echo-a",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Pod",
                "name": "echo-b",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Deployment",
                "name": "dep-test",
                "namespace": "test",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Deployment",
                "name": "echo-deployment",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 10,
                  "riskCategory": "High",
                  "riskItems": [
                    {
                      "name": "privileged",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Processes inside a privileged containers get full access to the code. A malicious, or library, can compromise the host and the entire cluster",
                      "score": 6
                    },
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "IngressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "A good ingress network policy would prevent external IPs to access a workload accidentally exposed to the host IP",
                      "score": 0.6
                    },
                    {
                      "name": "EgressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "An egress network policy can prevent the workload to be leveraged to perform lateral movement and data ex-filtration",
                      "score": 0.8
                    },
                    {
                      "name": "ExposedByLoadBalancer",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "ExposedByNodePort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Deployment",
                "name": "dep-test",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 5.2224,
                  "riskCategory": "Medium",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "IngressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "A good ingress network policy would prevent external IPs to access a workload accidentally exposed to the host IP",
                      "score": 0.6
                    },
                    {
                      "name": "EgressPolicy",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "An egress network policy can prevent the workload to be leveraged to perform lateral movement and data ex-filtration",
                      "score": 0.8
                    },
                    {
                      "name": "ExposedByLoadBalancer",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "ExposedByNodePort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "Make the service accessible from other networks and/or from the Internet",
                      "score": 2
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "DaemonSet",
                "name": "echo-daemon",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "StatefulSet",
                "name": "echo-state",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 10,
                  "riskCategory": "High",
                  "riskItems": [
                    {
                      "name": "privileged",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Processes inside a privileged containers get full access to the code. A malicious, or library, can compromise the host and the entire cluster",
                      "score": 6
                    },
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    },
                    {
                      "name": "ShareHostNetwork",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "May be exposed to external network and the Internet (Share Host Network), Can sniff traffic from host and other containers (Share Host Network)",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Pod",
                "name": "echo-a",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Pod",
                "name": "echo-b",
                "namespace": "example",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              },
              {
                "kind": "Deployment",
                "name": "dep-test",
                "namespace": "test",
                "domain": "cloud:example",
                "risk": {
                  "riskScore": 2.72,
                  "riskCategory": "Low",
                  "riskItems": [
                    {
                      "name": "AllowProvilegeEscalation",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Privilege escalation allows programs inside the container to run as root, even if the main process is not root.",
                      "score": 2
                    },
                    {
                      "name": "CapNetRaw",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This capability enables ARP spoofing from the container, UDP packets with forged source , IP, etc. Such capability enables the container to perform Man-in-the-Middle (MitM) attacks on the host network. This capability enables the container to craft malicious raw packet such as Ping of Death",
                      "score": 1
                    },
                    {
                      "name": "WritableFileSystem",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "This allows threats to persist through restart and upgrades of the container",
                      "score": 2
                    },
                    {
                      "name": "AllowedUnsafeSysctls",
                      "type": "Basic",
                      "shortDescription": "",
                      "description": "Some of the sysctl interfaces allows the container to grab more CPU resources than allowed by its quota. This may starve other containers from CPU cycles. Some of the sysctl interfaces allows the container to affect other containers and/or the host",
                      "score": 4
                    },
                    {
                      "name": "AppArmor",
                      "type": "Remediation",
                      "shortDescription": "",
                      "description": "SELinux (RedHat-based distributions) and AppArmor(Debian-based distributions) provides access control policies. They can be used to restrict how processes can communicate",
                      "score": 0.4
                    },
                    {
                      "name": "HostPort",
                      "type": "Aggravation",
                      "shortDescription": "",
                      "description": "This setting bind the workload listening IP address to the host IP, making the service accessible from other networks and/or from the Internet",
                      "score": 1.7
                    }
                  ]
                }
              }
            ]
        }
    }
---

apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: "1"
  labels:
    run: octaudit
  name: octaudit-deployment
spec:
  replicas: 1
  selector:
    matchLabels:
      run: octaudit
  strategy:
    rollingUpdate:
      maxSurge: 25%
      maxUnavailable: 25%
    type: RollingUpdate
  template:
    metadata:
      labels:
        run: octaudit
    spec:
      volumes:
        - name: fake-data
          configMap:
            name: fake-data
      containers:
        - image: clue/json-server
          imagePullPolicy: IfNotPresent
          name: json-server
          volumeMounts:
            - name: fake-data
              mountPath: /data
        - image: octarinesec/octaudit_ui:latest
          imagePullPolicy: Always
          name: octaudit-ui
          env:
            - name: API_SERVER_PORT
              value: "80"
            - name: CONTACT_LINK
              value: "mailto:info@octarinesec?subject=Octaudit%20Contact%20Request"
      dnsPolicy: ClusterFirst
      restartPolicy: Always
      terminationGracePeriodSeconds: 30

---

apiVersion: v1
kind: Service
metadata:
  labels:
    run: octaudit
  name: octaudit-svc
spec:
  externalTrafficPolicy: Cluster
  ports:
    - port: 8080
      protocol: TCP
      targetPort: 8080
  selector:
    run: octaudit
  type: LoadBalancer